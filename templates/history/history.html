{% extends "base.html" %}
{% block title %}History ‚Äì Stegado{% endblock %}

{% block content %}
<div class="page-wrapper">
    <div class="app-container wide">

        <header class="app-header">
            <h1>Operation <span class="accent">History</span></h1>
            <p>Your steganography activity log ‚Äî last 100 operations</p>
        </header>

        <div class="glass-panel">
            {% if records %}
            <div class="history-table-wrap">
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Operation</th>
                            <th>File</th>
                            <th>Type</th>
                            <th>Model</th>
                            <th>PSNR</th>
                            <th>Robustness</th>
                            <th>Timestamp</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for r in records %}
                        <tr>
                            <td style="color:var(--text-secondary);font-size:0.8rem">{{ loop.index }}</td>
                            <td>
                                <span class="op-badge {{ r.operation }}">
                                    {% if r.operation == 'hide' %}üîí Hide{% else %}üîç Extract{% endif %}
                                </span>
                            </td>
                            <td
                                style="color:var(--text-secondary);max-width:160px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">
                                {{ r.file_name or '‚Äî' }}
                            </td>
                            <td>
                                {% if r.result_type %}
                                <span class="type-badge">{{ r.result_type }}</span>
                                {% else %}‚Äî{% endif %}
                            </td>
                            <td style="font-size:0.8rem;color:var(--text-secondary)">
                                {{ r.model_used or '‚Äî' }}
                            </td>
                            <td>
                                {% if r.psnr_value %}
                                <span style="color:var(--success);font-weight:600">{{ r.psnr_value }} dB</span>
                                {% else %}‚Äî{% endif %}
                            </td>
                            <td>
                                {% if r.robustness_score %}
                                <span style="color:var(--accent-color);font-weight:600">{{ r.robustness_score }}%</span>
                                {% else %}‚Äî{% endif %}
                            </td>
                            <td style="font-size:0.8rem;color:var(--text-secondary)">
                                {{ r.timestamp.strftime('%d %b %Y, %H:%M') }}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="empty-state">
                <svg width="56" height="56" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                    <rect x="3" y="3" width="18" height="18" rx="2" />
                    <line x1="3" y1="9" x2="21" y2="9" />
                    <line x1="9" y1="21" x2="9" y2="9" />
                </svg>
                <p style="font-size:1.1rem;font-weight:600;margin-bottom:6px">No history yet</p>
                <p style="font-size:0.88rem">Start hiding or extracting secrets to see your activity here.</p>
                <a href="{{ url_for('hide.hide_page') }}" class="action-btn"
                    style="width:auto;padding:12px 28px;margin-top:20px;display:inline-flex">
                    Start Now
                </a>
            </div>
            {% endif %}
        </div>

    </div>
</div>
{% endblock %}